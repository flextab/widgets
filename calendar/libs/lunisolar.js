!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).lunisolar=e()}(this,(function(){"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function n(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}function r(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}var o="millisecond",i="second",a="minute",u="hour",c="week",s="month",l="quarter",f="year",h="lunarhour",g="lunarmonth",d="lunaryear",p=new Set(["lunarhour","lunarday","lunarmonth","lunaryear"]),m="Invalid Date",y=/\[([^\]]+)]|cZ|t|T|lYn|lMn|lDn|lHn|lY|lM|lL|lD|lH|cYs|cYb|cY|cMs|cMb|cM|cDs|cDb|cD|cHs|cHb|cH|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g;function v(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}const b="millisecond",_="second",j="minute",S="hour",M="week",O="month",T="year",w=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],D=["January","February","March","April","May","June","July","August","September","October","November","December"];var Y={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",q:"quarter",y:"year",lh:"lunarhour",ld:"lunarday",lM:"lunarmonth",ly:"lunaryear",ch:"char8hour",cd:"char8day",cM:"char8month",cy:"char8year"},C=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,P=864e5,U=2440587.5;function N(t,e){return void 0===e&&(e=!1),function(n,r,o){var i=void 0===o.value?o.get:o.value;o[void 0===o.value?"get":"value"]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(n.length>0&&e){var o=JSON.stringify(n);t+=o}if(this.cache.has(t))return this.cache.get(t);var a=i.call.apply(i,function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([this],n,!1));return this.cache.set(t,a),a}}}var H=function(t){return t?(t=t.trim(),Y[t]||(t||"").toLowerCase().replace(/s$/,"")):""};function L(t){return Math.floor(t)}function A(t){var e,n,r,o,i,a,u;if("number"==typeof t&&(t=new Date(t)),t instanceof Date)return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds(),millisecond:t.getUTCMilliseconds()};var c=new Date;return{year:null!==(e=null==t?void 0:t.year)&&void 0!==e?e:c.getUTCFullYear(),month:null!==(n=null==t?void 0:t.month)&&void 0!==n?n:c.getUTCMonth()+1,day:null!==(r=null==t?void 0:t.day)&&void 0!==r?r:c.getUTCDate(),hour:void 0===t?c.getUTCHours():null!==(o=t.hour)&&void 0!==o?o:0,minute:void 0===t?c.getUTCMinutes():null!==(i=t.minute)&&void 0!==i?i:0,second:void 0===t?c.getUTCSeconds():null!==(a=t.second)&&void 0!==a?a:0,millisecond:void 0===t?c.getUTCSeconds():null!==(u=t.millisecond)&&void 0!==u?u:0}}var x=function(t){var e=function(){var t=new Date;return{year:t.getFullYear(),month:t.getMonth()+1,day:1,hour:0,minute:0,second:0,millisecond:0}}(),n=(t=(t=t.replace("T"," ")).replace("Z","")).match(C);if(n){var r=(n[7]||"0").substring(0,3);e.year=Number(n[1]||e.year),e.month=Number(n[2]||0),e.day=Number(n[3]||1),e.hour=Number(n[4]||0),e.minute=Number(n[5]||0),e.second=Number(n[6]||0),e.millisecond=Number(r)}return e};function B(t,e){return void 0===e&&(e=0),(P+t+e)%P}function I(t){return t/864e5+U}function E(t){var e=t.jdn,n=t.jdms,r=function(t){return Math.floor(86400*(t-U)*1e3)}(e);return n?86400*Math.floor(r/864e5)*1e3+n:r}function z(t){return{jdn:I(t),jdms:t-86400*Math.floor(t/864e5)*1e3}}function k(t){return Math.round(86400*function(t){var e,n=String(t).split(".");return Number("".concat(n[0],".").concat(null!==(e=n[1])&&void 0!==e?e:0))}(t-.5)*1e3)}function Z(t,e){const n=Object.assign({},t._config,{isUTC:e,offset:0});return new G(t.jdn,n)}function F(t){return{jdn:t.jdn,jdms:t.jdms}}class G{constructor(t,e){var n,r,o,i;this.jdms=0,this.cache=new Map;let a={jdn:0,jdms:0},u={isUTC:!1,offset:0},c=!1;null==t?a=z((new Date).valueOf()):t instanceof G?(a=F(t),u=t._config):"object"==typeof t&&t.hasOwnProperty("jd")&&t.jd instanceof G?(a=F(t.jd),t.hasOwnProperty("_config")&&(u.isUTC=null!==(r=null===(n=t._config)||void 0===n?void 0:n.isUTC)&&void 0!==r&&r,u.offset=null!==(i=null===(o=t._config)||void 0===o?void 0:o.offset)&&void 0!==i?i:0)):"object"==typeof t&&"number"==typeof t.jdn||"number"==typeof t||t instanceof Date?a=function(t){var e;return t instanceof Date?z(t.valueOf()):"number"==typeof t?{jdn:t,jdms:k(t)}:{jdn:t.jdn,jdms:null!==(e=null==t?void 0:t.jdms)&&void 0!==e?e:k(t.jdn)}}(t):"number"!=typeof t&&("string"==typeof t&&(c=/Z$/i.test(t),t=x(t)),a.jdn=G.gre2jdn(t,null==e?void 0:e.isUTC),a.jdms=function(t,e){var n;void 0===e&&(e=!1);var r=0;e||(r+=60*(new Date).getTimezoneOffset()*1e3);var o=null!==(n=t.millisecond)&&void 0!==n?n:0;return B(60*t.hour*60*1e3+60*t.minute*1e3+1e3*t.second+o+r)}(A(t),null==e?void 0:e.isUTC)),this._config=function(t){for(var e in t)Object.defineProperty(t,e,{writable:!1});return t}(Object.assign({},u,e)),this.jdn=a.jdn,this.jdms=B(a.jdms),this.timezoneOffset=this._config.isUTC?0:(new Date).getTimezoneOffset(),c&&!this._config.isUTC&&(this.jdn-=this.timezoneOffset/1440,this.jdms=B(this.jdms,60*-this.timezoneOffset*1e3))}static gre2jdn(t,e=!1){return"string"==typeof t&&(t=x(t)),function(t,e){var n,r,o,i,a,u,c;void 0===e&&(e=!1);var s=A(t),l=new Date,f=null!==(n=null==s?void 0:s.year)&&void 0!==n?n:l.getFullYear(),h=null!==(r=null==s?void 0:s.month)&&void 0!==r?r:l.getMonth()+1,g=null!==(o=null==s?void 0:s.day)&&void 0!==o?o:l.getDate(),d=null!==(i=null==s?void 0:s.hour)&&void 0!==i?i:0,p=null!==(a=null==s?void 0:s.minute)&&void 0!==a?a:0,m=null!==(u=null==s?void 0:s.second)&&void 0!==u?u:0,y=null!==(c=null==s?void 0:s.millisecond)&&void 0!==c?c:0,v=l.getTimezoneOffset(),b=d/24+p/1440+m/86400+y/864e5;!t||t instanceof Date||e||(b+=v/1440);var _=0,j=0;return 372*f+31*h+L(g)>=588829&&(j=1),h<=2&&(h+=12,f--),j&&(_=2-(_=L(f/100))+L(_/4)),L(365.25*(f+4716))+L(30.6001*(h+1))+g+_-1524.5+b}(t,e)}static fromGre(t,e){return new G(t,e)}static fromJdn(t,e){return new G(t,e)}static fromTimestamp(t,e){return new G(z(t),e)}static jdn2gre(t,e=!1,n){return function(t,e,n){if(void 0===e&&(e=!1),!e){var r=-(new Date).getTimezoneOffset();t+=r/1440,n&&n>0&&(n=B(n,60*r*1e3))}var o,i={year:0,month:0,day:0,hour:0,minute:0,second:0,millisecond:0},a=L(t+.5),u=t+.5-a;if(a>=2299161&&(a+=1+(o=L((a-1867216.25)/36524.25))-L(o/4)),a+=1524,i.year=L((a-122.1)/365.25),a-=L(365.25*i.year),i.month=L(a/30.601),a-=L(30.601*i.month),i.day=a,i.month>13?(i.month-=13,i.year-=4715):(i.month-=1,i.year-=4716),n&&n>0){var c=function(t){var e=L(t/36e5),n=t-60*e*60*1e3,r=L(n/6e4),o=L((n-=6e4*r)/1e3);return{hour:e,minute:r,second:o,millisecond:n-=o}}(n);i.hour=c.hour,i.minute=c.minute,i.second=c.second,i.millisecond=c.millisecond}else u*=24,i.hour=L(u),u-=i.hour,u*=60,i.minute=L(u),u-=i.minute,u*=60,i.second=Math.round(u),i.second>59&&(i.second-=60,i.minute++),i.minute>59&&(i.minute-=60,i.hour++);return i}(t,e,n)}toGre(){const t=this.jdn,e=this._config.offset/1440,n=B(this.jdms,60*this._config.offset*1e3);return G.jdn2gre(t+e,this._config.isUTC,n)}clone(){return new G({jdn:this.jdn,jdms:this.jdms},this._config)}local(){return Z(this,!1)}utc(){return Z(this,!0)}isUTC(){return this._config.isUTC}get year(){return this.toGre().year}get month(){return this.toGre().month}get day(){return this.toGre().day}get hour(){return this.toGre().hour}get minute(){return this.toGre().minute}get second(){return this.toGre().second}get millisecond(){return this.toGre().millisecond}get dayOfWeek(){let t=this._config.isUTC?0:-this.timezoneOffset/1440;return t+=this._config.offset,L(this.jdn+1.5+7e6+t)%7}get timestamp(){return Math.round(E({jdn:this.jdn,jdms:this.jdms}))}toDate(){return new Date(this.timestamp)}toISOString(){return this.year>1900?this.toDate().toISOString():this.utc().format("YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}toUTCString(){return this.year>1900?this.toDate().toUTCString():this.utc().format("ddd, DD MMM YYYY HH:mm:ss [GMT]")}toString(){if(this.year>1900)return this.toDate().toString();const t=(new Date).toString().split(" ").slice(-1);return this.local().format(`ddd, DD MMM YYYY HH:mm:ss [GMT]ZZ [${t}]`)}valueOf(){return this.jdn}add(t,e){const n=H(e);let r=t,o=this.jdn,i=this.jdms;if(n===S)r=t/24,i=i?B(i,60*t*60*1e3):0;else if(n===j)r=t/1440,i=i?B(i,60*t*1e3):0;else if(n===_)r=t/86400,i=i?B(i,1e3*t):0;else if(e===O||e===T){const n=G.jdn2gre(this.jdn,this._config.isUTC);r=0,e===O&&(n.month+=t),e===T&&(n.year+=t),o=G.gre2jdn(n,this._config.isUTC)}else e===M?r=t/7:e===b&&(r=t/864e5,i=i?B(i,t):0);return new G({jdn:o+r,jdms:i},this._config)}format(t){const e=t||"YYYY-MM-DD HH:mm:ss",n=(t,e,n)=>{const r=t<12?"AM":"PM";return n?r.toLowerCase():r},r=this.year,o=this.month,i=this.day,a=this.hour,u=this.minute,c=this.second,s=this.dayOfWeek,l=a%12||12,f=(t=>{const e=Math.abs(t),n=Math.floor(e/60),r=e%60;return`${t<=0?"+":"-"}${String(n).padStart(2,"0")}:${String(r).padStart(2,"0")}`})(this.timezoneOffset),h={J:String(this.jdn),YY:String(r).slice(-2),YYYY:String(r),M:String(o),MM:String(o).padStart(2,"0"),MMM:D[o-1].slice(0,3),MMMM:D[o-1],D:String(i),DD:String(i).padStart(2,"0"),d:String(s),dd:w[s].slice(0,2),ddd:w[s].slice(0,3),dddd:w[s],H:String(a),HH:String(a).padStart(2,"0"),h:String(l),hh:String(l).padStart(2,"0"),a:n(a,0,!0),A:n(a,0,!1),m:String(u),mm:String(u).padStart(2,"0"),s:String(c),ss:String(c).padStart(2,"0"),S:String(Math.floor(this.millisecond/100)),SS:String(Math.floor(this.millisecond/10)).padStart(2,"0"),SSS:String(Math.floor(this.millisecond)).padStart(3,"0"),Z:f,ZZ:f.replace(":","")};return e.replace(/\[([^\]]+)]|J|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,((t,e)=>e||h[t]))}}v([N("jd:toGre")],G.prototype,"toGre",null),v([N("jd:timestamp")],G.prototype,"timestamp",null);var $=[[9],[5,9,7],[0,2,4],[1],[4,1,9],[2,6,4],[3,5],[5,3,1],[6,8,4],[7],[4,7,3],[8,0]],J=[2018,12,7],R=[2022,3,12],V={name:"zh",leap:"閏",lunarYearUnit:"年",lunarHourUnit:"時",bigMonth:"大",smallMonth:"小",weekdays:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],weekdaysShort:["週日","週一","週二","週三","週四","週五","週六"],weekdaysMin:["日","一","二","三","四","五","六"],months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),lunarMonths:"正月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),lunarMonthsAlias:"正月_二月_三月_四月_五月_六月_七月_八月_九月_十月_冬月_腊月".split("_"),lunarDays:"初一_初二_初三_初四_初五_初六_初七_初八_初九_初十_十一_十二_十三_十四_十五_十六_十七_十八_十九_二十_廿一_廿二_廿三_廿四_廿五_廿六_廿七_廿八_廿九_三十".split("_"),numerals:"〇一二三四五六七八九十".split(""),constellationName:"白羊座_金牛座_雙子座_巨蟹座_狮子座_處女座_天秤座_天蝎座_射手座_摩羯座_水瓶座_雙魚座".split("_"),solarTerm:"小寒_大寒_立春_雨水_驚蟄_春分_清明_穀雨_立夏_小滿_芒種_夏至_小暑_大暑_立秋_處暑_白露_秋分_寒露_霜降_立冬_小雪_大雪_冬至".split("_"),seasonName:"春夏秋冬".split(""),stems:["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],branchs:["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],stemBranchSeparator:"",chineseZodiac:["鼠","牛","虎","兔","龍","蛇","馬","羊","猴","雞","狗","豬"],fiveElements:["木","火","土","金","水"],eightTrigram:"坤震坎兌艮離巽乾".split(""),moonPhase:{"朔":"朔","望":"望","弦":"弦","晦":"晦"},directions:["","北","西南","東","東南","中","西北","西","東北","南"],formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah點mm分",LLLL:"YYYY年M月D日ddddAh點mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},meridiem:function(t,e){var n=100*t+e;return n<600?"凌晨":n<900?"早上":n<1100?"上午":n<1300?"中午":n<1800?"下午":"晚上"}},W={isUTC:!1,offset:0,changeAgeTerm:2,locales:{zh:V},lang:"zh"},q=1901,K=2100,Q=[1874,3749,43818,1611,2715,39590,1386,2905,19370,1874,52645,2853,2635,47691,685,1387,17845,3497,65170,3730,3365,44333,2646,694,39637,1748,3753,20298,3730,50854,1323,2647,47446,2906,1748,30561,1865,64275,2707,1323,54555,2733,1386,40357,2980,2889,19787,2709,60077,1334,2733,47818,1458,3493,32418,3402,66965,2711,1366,50549,2773,1746,34645,3749,1610,26191,2715,60122,1386,2921,43954,2898,2853,35627,2635,68267,685,1389,54697,3497,3474,36501,3365,85581,2646,694,49909,1749,3753,44882,3730,3366,25902,2647,68310,858,1749,43881,1865,1683,35483,1323,2651,19118,1386,60885,2980,2889,44371,2709,1325,34141,2741,76714,1490,3493,56970,3402,3221,35486,1366,2741,19162,1746,51045,1829,1611,42583,3243,1370,25966,2921,94034,2898,2853,56587,2635,1195,41659,1453,2922,19882,3474,61093,3365,2645,47693,1206,1461,30418,3785,69522,3730,3366,54550,2647,1366,37733,1877,1865,26443,1683,60075,1323,2651,43706,1386,2917,35754,2890,69013,2709,1325,50541,2741,1450,34261,3493,3402,28237,3222,60622,1366,2741,47826,1746,3749,34602,1675,67223,1195,1371,54614,2922,1874,35733,2885,2699,19023,1195],X=[219,208,129,216,204,125,213,202,122,210,130,218,206,126,214,203,123,211,201,220,208,128,216,205,124,213,202,123,210,130,217,206,126,214,204,124,211,131,219,208,127,215,205,125,213,202,122,210,129,217,206,127,214,203,124,212,131,218,208,128,215,205,125,213,202,121,209,130,217,206,127,215,203,123,211,131,218,207,128,216,205,125,213,202,220,209,129,217,206,127,215,204,123,210,131,219,207,128,216,205,124,212,201,122,209,129,218,207,126,214,203,123,210,131,219,208,128,216,205,125,212,201,122,210,129,217,206,126,213,203,123,211,131,219,208,128,215,204,124,212,201,122,210,130,217,206,126,214,202,123,211,201,219,208,128,215,204,124,212,202,121,209,129,217,205,126,214,203,123,211,131,219,207,127,215,205,124,212,202,122,209,129,217,206,126,214,203,124,210,130,218,207,127,215,205,125,212,201,121,209],tt=[4,19,3,18,4,19,4,19,4,20,4,20,6,22,6,22,6,22,7,22,6,21,6,21],et=[0x6aaaa6aa9a5a,0xaaaaaabaaa6a,0xaaabbabbafaa,99670716471979,0xaaaaaaaaaa6a,0x6aaaa6aa9a56,0xaaaaaaaa9a5a,0xaaabaabaaeaa,95203950484138,99671807007318,0x6aaaaaaa9a5a,99671806990934,0xaaabaabaaa6a,93829556755114,99670716471894,93829556689578,95203950484054,0x6aa6a6aa9a56,93829288253866,95203950484053,0x6aa6a6a65a56,93829288252842,93824993285482,93829556755029,93824992236906,93829556689493,0x6aa6a6aa9a5a,93824992232810,93829288254037,99601996995158,0x6aa6a6a69a5a,93824925123930,93829288253781,99671790213718,23456180946266,93824993285461,95203946289749,93824993285397,93824992236821,23439001077082,93824992232725,23439000814938,93824925123861,23439000798550,93824925123845,23437910279510,23456180946181,5845724235094,23439000814853,5777004758358,23439000798469,1378954052950,23437910279425,1378954052949,93824992236885,5845724235009,4564518229,4296017237,5777004758273,23438984021253,1378954052865,23437910279429,1048661,1378954052864,85,4564518144,21,4296082688],nt=[0,1,2,3,0,4,2,3,0,4,2,3,5,6,7,8,9,10,7,8,11,10,12,8,11,0,1,13,14,0,1,13,14,0,4,13,14,0,4,13,14,0,4,15,16,17,6,18,19,20,6,18,19,11,0,21,19,14,0,22,23,14,0,22,23,14,0,24,23,14,0,24,25,14,26,27,28,29,30,27,28,16,20,31,32,19,33,34,35,36,14,34,37,23,14,34,38,23,14,34,38,23,14,34,38,28,14,39,40,28,29,41,42,28,16,43,44,32,36,45,46,35,36,47,46,38,23,47,46,38,23,47,46,38,28,47,46,38,28,47,48,40,28,49,50,42,28,51,52,44,35,53,52,44,54,53,55,46,54,56,55,46,38,56,55,46,38,57,55,48,38,57,58,48,42,57,58,59,42,57,60,61,44,62,63,52,44,64,63,55,46,64,65,55,46,66,67,55,46,38],rt=function(t,e){void 0===e&&(e=!1);var n=X[t-q],r=st("".concat(t,"/").concat(Math.floor(n/100),"/").concat(n%100));return e?r.utc():r},ot=function(t){var e=Q[t-q];return[e>>13,1===(e>>12&1)]},it=function(t,e,n){var r;void 0===n&&(n=!1),function(t,e){var n=W.locales[null!=e?e:W.lang];if("string"==typeof t.year){for(var r="",o=0;o<t.year.length;o++){var i=-1;r+=(i="零"===t.year[o]||"〇"===t.year[o]?0:n.numerals.indexOf(t.year[o]))>=0?i:""}t.year=Number(r)}if("string"==typeof t.month){var a=t.month;a[0]===n.leap&&(t.isLeapMonth=!0,a=t.month.slice(1));var u=n.lunarMonths.indexOf(a);-1===u&&(u=n.lunarMonthsAlias.indexOf(a)),t.month=t.isLeapMonth?u+100+1:u+1}"string"==typeof t.day&&(t.day=n.lunarDays.indexOf(t.day)+1),"string"==typeof t.hour&&(t.hour=n.branchs.indexOf(t.hour))}(t,e);var o=new Date,i=t.year?Number(t.year):o.getFullYear(),a=Number(t.month),u=Number(t.day),c=t.hour?Number(t.hour):0,s=null!==(r=t.isLeapMonth)&&void 0!==r&&r;if(a>100&&(a-=100,s=!0),i<q||i>K)throw new Error("Invalid lunar year: out of range");if(a<1)throw new Error("Invalid lunar month");var l=rt(i,n),f=ot(i),h=f[0],g=f[1];if(s&&h!==a)throw new Error("Invalid lunar leap month: no this leap month");for(var d=Q[i-q],p=s?g:d>>a-1&1,m=0,y=0;y<a;y++){if(m+=d>>y&1?30:29,y===a-1&&!s)break;y===h-1&&(m+=g?30:29)}return m-=(p?30:29)-u+1,st({jdn:l.jdn+m+2*c/24},n)},at=function(t,e,n,r){void 0===r&&(r=!1);var o=st(t,r,void 0,!0),i=st(n,r).day,a=o.month-1,u=e/2>>0,c=u<a||0===a&&11===u||i>o.day&&!(i-1===o.day&&o.hour>=23)?-1:0;return((12*(o.year-J[0])+o.month-1-J[1]+1)%60+c+60)%60};var ut={stem:[10,"stems"],branch:[12,"branchs"],trigram8:[8,"eightTrigram"],element5:[5,"fiveElements"]},ct=function(t,e,n,r){if("number"==typeof t)t%=ut[e][0];else if("string"==typeof t){var o=r.locales[n][ut[e][1]].indexOf(t);if(-1===o)throw new Error("Invalid ".concat(e," value"));t=o}return t},st=function(t,e,n,r){var o,i;if(void 0===r&&(r=!1),null===t)throw Error("Invalid Date");if(r&&t instanceof G&&e===t.isUTC())return t;var a={isUTC:null!=e&&e,offset:null!=n?n:0};if("number"==typeof t)return G.fromTimestamp(t,a);if(t&&"object"==typeof t&&!(t instanceof Date)){if(t.hasOwnProperty("_config")||t.hasOwnProperty("config")){var u=t._config;a={isUTC:null!==(o=null!=e?e:null==u?void 0:u.isUTC)&&void 0!==o&&o,offset:null!==(i=null!=n?n:null==u?void 0:u.offset)&&void 0!==i?i:0}}if(t.hasOwnProperty("toDate")&&"function"==typeof t.toDate&&!t.hasOwnProperty("jd")&&!t.hasOwnProperty("jdn"))return new G(t.toDate,a)}return new G(t,a)},lt={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",q:"quarter",y:"year",lh:"lunarhour",ld:"lunarday",lM:"lunarmonth",ly:"lunaryear",ch:"char8hour",cd:"char8day",cM:"char8month",cy:"char8year"},ft=function(t){return t?(t=t.trim(),lt[t]||(t||"").toLowerCase().replace(/s$/,"")):""};function ht(t,e,n,r){var h=[st(t,void 0,void 0,!0),st(e,void 0,void 0,!0)],g=h[0],d=h[1],p=g.jdn-d.jdn;n=n?ft(n):"millisecond";var m=p;return i===n?m=24*p*60*60:a===n?m=24*p*60:u===n?m=24*p:o===n?m=24*p*60*60*1e3:c===n?m=p/7:s===n?m=gt(g,d):f===n?m=gt(g,d)/12:l===n&&(m=gt(g,d)/3),r?m:parseInt(String(m))}var gt=function(t,e){var n,r=[st(t,void 0,void 0,!0),st(e,void 0,void 0,!0)],o=r[0],i=r[1],a=1;o.jdn<i.jdn&&(o=(n=[i,o])[0],i=n[1],a=-1);var u=12*(i.year-o.year)+(i.month-o.month),c=o.add(u,"month"),s=c.jdn>i.jdn,l=o.add(u+(s?-1:1),"month"),f=s?c.jdn-l.jdn:l.jdn-c.jdn;return-a*(u+(0===f?0:(i.jdn-c.jdn)/f))},dt=function(t,e,n){if(t<e)return-dt(e,t,n);for(var r=[t.lunar,e.lunar],o=r[0],i=r[1],a=[o.year,i.year],u=a[0],c=a[1],s=[o.month,i.month],l=s[0],f=s[1],h=c,g=0;h<=u;){var d=[1,12],p=d[0],m=d[1];h===c&&(p=f),h===u&&(m=l),g+=pt(h,p,m),h++}if(!n)return g-1;if(g>0)g+=mt(e,!0)+mt(t,!1)-2;else{var y=i.isBigMonth?30:29;g=(t.jd.jdn-e.jd.jdn)/y}return g},pt=function(t,e,n){var r=!1;(e=e||1)>100&&(e-=100,r=!0),(n=n||12)>100&&(n-=100,r=!0);var o=Q[t-q]>>13;return e<=o&&o<=n&&(r=!0),n-e+1+(r?1:0)},mt=function(t,e){void 0===e&&(e=!1);var n=t.lunar.isBigMonth?30:29,r=t.lunar.day;return e?1-r/n:r/n},yt=function(t,e){void 0===e&&(e=!1);var n=t.lunar.leapMonth,r=n>0?13:12,o=!1,i=t.lunar.month;i>100&&(i-=100,o=!0),n>0&&(i>n||i===n&&o)&&i++;var a=mt(t,e);return e?1-(i-a)/r:(i+a-1)/r},vt=function(t,e){if(e.toUTCString()===m)return m;var n,r,o,i,a=t||"YYYY-MM-DDTHH:mm:ssZ",u=e.year,c=e.month,s=e.day,l=e.dayOfWeek,f=e.hour,h=e.minute,g=e.second,d=(n=-e.utcOffset(),r=Math.abs(n),o=Math.floor(r/60),i=r%60,"".concat(n<=0?"+":"-").concat(String(o).padStart(2,"0"),":").concat(String(i).padStart(2,"0"))),p=e.lunar,v=e.char8,b=W.locales[e._config.lang],_=b.weekdays,j=b.months,S=function(t,e,n,r){return t&&t[e]||(n?n[e].slice(0,r):"")},M=f%12||12,O=b.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},T={YY:String(u).slice(-2),YYYY:String(u),M:String(c),MM:String(c).padStart(2,"0"),MMM:S(b.monthsShort,c-1,j,3),MMMM:S(j,c-1),D:String(s),DD:String(s).padStart(2,"0"),d:String(l),dd:S(b.weekdaysMin,l,_,2),ddd:S(b.weekdaysShort,l,_,3),dddd:_[l],H:String(f),HH:String(f).padStart(2,"0"),h:String(M),hh:String(M).padStart(2,"0"),a:O(f,h,!0),A:O(f,h,!1),m:String(h),mm:String(h).padStart(2,"0"),s:String(g),ss:String(g).padStart(2,"0"),SSS:String(e.millisecond).padStart(3,"0"),Z:d,cZ:b.chineseZodiac[v.year.branch.value],t:e.solarTerm?String(e.solarTerm.value+1):"",T:e.solarTerm?e.solarTerm.toString():"",lY:p.getYearName(),lM:p.getMonthName(),lD:p.getDayName(),lH:p.getHourName(),lL:p.isBigMonth?b.bigMonth:b.smallMonth,lYn:String(p.year),lMn:String(p.month),lDn:String(p.day),lHn:String(p.hour+1),cY:v.year.toString(),cYs:v.year.stem.toString(),cYb:v.year.branch.toString(),cM:v.month.toString(),cMs:v.month.stem.toString(),cMb:v.month.branch.toString(),cD:v.day.toString(),cDs:v.day.stem.toString(),cDb:v.day.branch.toString(),cH:v.hour.toString(),cHs:v.hour.stem.toString(),cHb:v.hour.branch.toString()};return a=a.replace(y,(function(t,e){return e||T[t]||d.replace(":","")}))};function bt(t,e){return Math.round(e.jdn-t.jdn)}var _t=function(){function t(t,e){var n;this._config={lang:W.lang,isUTC:!1},e&&(this._config=Object.assign({},this._config,e));var r=t instanceof G?t._config.offset:0;this.jd=st(t,this._config.isUTC,r);var o=this.jd.year,i=this.jd.month-1,a=this.jd.hour,u=this.jd.day,c=st("".concat(o,"/").concat(i+1,"/").concat(u),this._config.isUTC);if(o<q||o>K||o===q&&i<1||o===q&&1===i&&c.day<19)throw new Error("Invalid lunar year: out of range");var s=bt(rt(o),c);c&&23===a&&(s+=1),s<0&&(s=bt(rt(o-=1),c)),this.year=o;var l=ot(o),f=l[0],h=l[1];this.leapMonth=f,this.leapMonthIsBig=h,n=function(t,e,n){var r=Q[t-q],o=n||ot(t),i=o[0],a=o[1],u=1;e+=1;for(var c=!1;e>29;){if(e-=r>>u-1&1?30:29,u===i&&e>0){var s=a?30:29;if(!(e>s)){c=!0;break}e-=s}u++}return c&&(u+=100),0===e&&(e=30,u--),[u,e]}(o,s,[f,h]),this.month=n[0],this.day=n[1],this.hour=(a+1)%24>>1}return t.fromLunar=function(e,n){return new t(it(e,null==n?void 0:n.lang),n)},Object.defineProperty(t.prototype,"isLeapMonth",{get:function(){return this.month>100},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBigMonth",{get:function(){var t=Q[this.year-q];return this.isLeapMonth?1==(t>>12&1):1==(t>>this.month-1&1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLastDayOfMonth",{get:function(){return!(!this.isBigMonth||30!==this.day)||!this.isBigMonth&&29===this.day},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lunarNewYearDay",{get:function(){return rt(this.year)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastDayOfYear",{get:function(){var t=rt(this.year+1);return st({jdn:t.jdn-1})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"phaseOfTheMoon",{get:function(){return function(t,e){var n=t.day;return 1===n?e.moonPhase.朔:[7,8,22,23].includes(n)?e.moonPhase.弦:15===n?e.moonPhase.望:t.isLastDayOfMonth?e.moonPhase.晦:""}(this,W.locales[this._config.lang])},enumerable:!1,configurable:!0}),t.prototype.toDate=function(){return this.jd.toDate()},t.prototype.getYearName=function(){for(var t="",e=this.year,n=W.locales[this._config.lang].numerals;e;){t=n[e%10]+t,e=Math.floor(e/10)}return t},t.prototype.getMonthName=function(){var t=W.locales[this._config.lang].lunarMonths,e=W.locales[this._config.lang].leap;return(this.isLeapMonth?e:"")+t[this.month%100-1]},t.prototype.getDayName=function(){return W.locales[this._config.lang].lunarDays[this.day-1]},t.prototype.getHourName=function(){return W.locales[this._config.lang].branchs[this.hour]},t.prototype.toString=function(){var t=W.locales[this._config.lang];return"".concat(this.getYearName()).concat(t.lunarYearUnit).concat(this.getMonthName()).concat(this.getDayName()).concat(this.getHourName()).concat(t.lunarHourUnit)},t.prototype.valueOf=function(){return this.jd.timestamp},t.getLunarNewYearDay=function(t){return rt(t)},t}(),jt=function(){function t(e,n){if(this.value=-1,this._config={lang:W.lang,isUTC:!1},n&&(this._config=Object.assign({},this._config,n)),e instanceof t)return e;if("number"==typeof e)this.value=e%24;else if("string"==typeof e){var r=W.locales[this._config.lang].solarTerm.indexOf(e);if(-1===r)throw new Error("Invalid term value");this.value=r}}return Object.defineProperty(t.prototype,"name",{get:function(){return String(W.locales[this._config.lang].solarTerm[this.value])},enumerable:!1,configurable:!0}),t.getNames=function(t){return t=t||W.lang,r([],W.locales[t].solarTerm,!0)},t.getYearTermDayList=function(t){for(var e=[],n=et[nt[t-q]].toString(2).padStart(48,"0");e.length<24;){var r=parseInt(n.slice(n.length-2),2),o=tt[e.length];e.push(r+o),n=n.slice(0,n.length-2)}return e},t.getMonthTerms=function(t,e){var n=et[nt[t-q]].toString(2).padStart(48,"0"),r=4*(e-1),o=parseInt(n.slice(n.length-r-4,n.length-r),2);return[(3&o)+tt[2*(e-1)],(o>>2&3)+tt[2*(e-1)+1]]},t.findDate=function(e,n,r){var o=r&&r.lang?r.lang:W.lang;return n instanceof t&&(n=n.value),[e,((n="string"==typeof n?W.locales[o].solarTerm.indexOf(n):n%24)>>1)+1,t.getYearTermDayList(e)[n]]},t.findNode=function(e,n){var r,o={lang:W.lang,returnValue:!1,nodeFlag:0,isUTC:!1},i=n?Object.assign({},o,n):o,a=i.returnValue,u=i.nodeFlag;if(u>2)throw new Error("Invalid nodeFlag");var c,s={lang:i.lang||W.lang},l=st(e,i.isUTC,void 0,!0),f=l.year,h=l.month-1,g=l.day,d=l.hour,p=(2*h+24)%24,m=t.getMonthTerms(f,h+1),y=m[0],v=m[1],b=!1,_=!1;g<y&&!(g===y-1&&d>=23)?b=!0:g<v&&!(g===v-1&&d>=23)&&(_=!0,1===u&&(b=!0));var j=!1;b?(h-1<0?(f--,h=11):h--,p=(2*h+24)%24,y=(r=t.getMonthTerms(f,h+1))[0],v=r[1],u>0&&(j=!0)):(1===u||2===u&&!_)&&(j=!0),c=j?v:y,p=j?(p+1)%24:p;var S=st("".concat(f,"-").concat(h+1,"-").concat(c),i.isUTC);return a?[p,S]:[new t(p,s),S]},t.prototype.valueOf=function(){return this.value},t.prototype.toString=function(){return this.name},t}(),St=function(){function t(e,n){if(this.value=-1,this._config={lang:W.lang},e instanceof t)return e;n&&(this._config=Object.assign({},this._config,n)),this.value=ct(e,"element5",this._config.lang,W)}return t.getNames=function(t){return t=t||W.lang,r([],W.locales[t].fiveElements,!0)},t.create=function(e,n){if(e instanceof t)return e;var r=(null==n?void 0:n.lang)||W.lang;e=ct(e,"element5",r,W);var o="".concat(e,":").concat(r);if(t.instances.has(o))return t.instances.get(o);var i=new t(e,n);return t.instances.set(o,i),i},Object.defineProperty(t.prototype,"name",{get:function(){return-1===this.value?"":W.locales[this._config.lang].fiveElements[this.value]},enumerable:!1,configurable:!0}),t.prototype.generating=function(){var e=(this.value+1)%5;return t.create(e,this._config)},t.prototype.overcoming=function(){var e=(this.value+2)%5;return t.create(e,this._config)},t.prototype.weakening=function(){var e=(this.value+4)%5;return t.create(e,this._config)},t.prototype.counteracting=function(){var e=(this.value+3)%5;return t.create(e,this._config)},t.prototype.toString=function(){return-1===this.value?"Invalid five-element value":this.name},t.prototype.valueOf=function(){return this.value},t.instances=new Map,t}(),Mt=function(){function t(t,e){this.value=-1,this._config={lang:W.lang},e&&(this._config=Object.assign({},this._config,e)),this.value=t%8}return t.getNames=function(t){return t=t||W.lang,r([],W.locales[t].eightTrigram,!0)},t.create=function(e,n){var r=(null==n?void 0:n.lang)||W.lang;e=ct(e,"trigram8",r,W);var o="".concat(e,":").concat(r);if(t.instances.has(o))return t.instances.get(o);var i=new t(e,n);return t.instances.set(o,i),i},Object.defineProperty(t.prototype,"name",{get:function(){return W.locales[this._config.lang].eightTrigram[this.value]},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.name},t.prototype.valueOf=function(){return this.value},t.instances=new Map,t}(),Ot=function(){this.cache=new Map},Tt=function(t){function o(e,n){var r=t.call(this)||this;return r.value=-1,r._config={lang:W.lang},e instanceof o?e:(n&&(r._config=Object.assign({},r._config,n)),r.value=ct(e,"branch",r._config.lang,W),r)}return e(o,t),o.getNames=function(t){return t=t||W.lang,r([],W.locales[t].branchs,!0)},o.create=function(t,e){if(t instanceof o)return t;var n=(null==e?void 0:e.lang)||W.lang;t=ct(t,"branch",n,W);var r="".concat(t,":").concat(n);if(o.instances.has(r))return o.instances.get(r);var i=new o(t,e);return o.instances.set(r,i),i},Object.defineProperty(o.prototype,"name",{get:function(){return W.locales[this._config.lang].branchs[this.value]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hiddenStems",{get:function(){return $[this.value].map((function(t){return new wt(t)}))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"e5",{get:function(){var t=Math.floor((this.value+10)/3)%4;return(this.value+10)%3==2?St.create(2,this._config):St.create(t<2?t:t+1,this._config)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"triad",{get:function(){return[o.create((this.value+4)%12,this._config),o.create((this.value+8)%12,this._config)]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"triadE5",{get:function(){return St.create([4,0,1,3][this.value%4],this._config)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"group6",{get:function(){return o.create((13-this.value)%12,this._config)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"group6E5",{get:function(){return St.create((t=this.value,e=[2,0,1,3,4,2],(t=0===t?12:t)<7?e[t-1]:e[12-t]),this._config);var t,e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"punishing",{get:function(){return o.create([3,10,5,0,4,8,6,1,2,9,7,11][this.value],this._config)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"punishBy",{get:function(){return o.create([3,7,8,0,4,2,6,10,5,9,1,11][this.value],this._config)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"conflict",{get:function(){return o.create((this.value+6)%12,this._config)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"destroying",{get:function(){return o.create([9,4,11,6,1,8,3,10,5,0,7,2][this.value],this._config)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"harming",{get:function(){var t=this.value>7?19-this.value:7-this.value;return o.create(t,this._config)},enumerable:!1,configurable:!0}),o.prototype.toString=function(){return this.name},o.prototype.valueOf=function(){return this.value},o.instances=new Map,n([N("branch:hiddenStems")],o.prototype,"hiddenStems",null),n([N("branch:e5")],o.prototype,"e5",null),n([N("branch:punishing")],o.prototype,"punishing",null),n([N("branch:punishBy")],o.prototype,"punishBy",null),n([N("branch:conflict")],o.prototype,"conflict",null),n([N("branch:destroying")],o.prototype,"destroying",null),n([N("branch:harming")],o.prototype,"harming",null),o}(Ot),wt=function(t){function o(e,n){var r=t.call(this)||this;return r.value=-1,r._config={lang:W.lang},e instanceof o?e:(n&&(r._config=Object.assign({},r._config,n)),r.value=ct(e,"stem",r._config.lang,W),r)}return e(o,t),o.getNames=function(t){return t=t||W.lang,r([],W.locales[t].stems,!0)},o.create=function(t,e){if(t instanceof o)return t;var n=(null==e?void 0:e.lang)||W.lang;t=ct(t,"stem",n,W);var r="".concat(t,":").concat(n);if(o.instances.has(r))return o.instances.get(r);var i=new o(t,e);return o.instances.set(r,i),i},Object.defineProperty(o.prototype,"name",{get:function(){return W.locales[this._config.lang].stems[this.value]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"branchs",{get:function(){var t=this;return W.locales[this._config.lang].branchs.filter((function(e,n){return n%2==t.value%2})).map((function(e){return Tt.create(e,t._config)}))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"e5",{get:function(){return St.create(Math.floor(this.value/2),this._config)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"trigram8",{get:function(){return Mt.create([7,0,4,3,2,5,1,5,7,0][this.value],this._config)},enumerable:!1,configurable:!0}),o.prototype.toString=function(){return this.name},o.prototype.valueOf=function(){return this.value},o.instances=new Map,n([N("stem:branchs")],o.prototype,"branchs",null),n([N("stem:e5")],o.prototype,"e5",null),o}(Ot),Dt=function(){function t(t,e,n){if(this.value=-1,this._config={lang:W.lang},n&&(this._config=Object.assign({},this._config,n)),"number"==typeof e||"string"==typeof e||e instanceof Tt){this.stem=wt.create(t,this._config),this.branch=Tt.create(e,this._config);var r=this.stem.valueOf(),o=this.branch.valueOf();this.value=function(t,e){if((t+e)%2!=0)throw new Error("Invalid SB value");return t%10+(6-(e>>1)+(t>>1))%6*10}(r,o)}else{if("number"!=typeof t)throw new Error("Invalid SB value");this.value=t%60;r=this.value%10,o=this.value%12;this.stem=wt.create(r,this._config),this.branch=Tt.create(o,this._config)}}return t.getNames=function(t){t=t||W.lang;var e=W.locales[t];return new Array(60).fill("").map((function(t,n){var r,o=n%10,i=n%12;return e.stems[o]+(null!==(r=null==e?void 0:e.stemBranchSeparator)&&void 0!==r?r:"")+e.branchs[i]}))},t.create=function(e,n){if(e instanceof t)return e;var r=(null==n?void 0:n.lang)||W.lang,o="".concat(e,":").concat(r);if(t.instances.has(o))return t.instances.get(o);var i=new t(e,void 0,n);return t.instances.set(o,i),i},Object.defineProperty(t.prototype,"missing",{get:function(){var t=2*(5-Math.floor(this.value/10));return[Tt.create(t,this._config),Tt.create(t+1,this._config)]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){var t,e=W.locales[this._config.lang];return"".concat(this.stem).concat(null!==(t=null==e?void 0:e.stemBranchSeparator)&&void 0!==t?t:"").concat(this.branch)},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.name},t.prototype.valueOf=function(){return this.value},t.instances=new Map,t}(),Yt=function(){function t(e,n){if(this.value=-1,this._config={changeAgeTerm:W.changeAgeTerm,isUTC:!1,lang:W.lang,offset:0},n&&(this._config=Object.assign({},this._config,n)),e instanceof Date||e instanceof G){var r=t.computeSBYear(e,this._config),o=t.computeSBMonth(e,this._config),i=t.computeSBDay(e,this._config);e=[r,o,i,t.computeSBHour(e,i,this._config)]}if(!Array.isArray(e))throw new Error("Invalid Char8");this._list=e,this.value=t.computeValue(e)}return t.prototype.getConfig=function(){return Object.assign({},this._config)},Object.defineProperty(t.prototype,"list",{get:function(){return this._list},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"year",{get:function(){return this._list[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"month",{get:function(){return this._list[1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"day",{get:function(){return this._list[2]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hour",{get:function(){return this._list[3]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"me",{get:function(){return this._list[2].stem},enumerable:!1,configurable:!0}),t.computeValue=function(t){for(var e=0,n=0;n<4;n++)e+=t[n].valueOf()*Math.pow(10,2*(3-n));return e},t.computeSBYear=function(t,e){var n=e&&void 0!==e.changeAgeTerm?e.changeAgeTerm:W.changeAgeTerm,r=e&&e.isUTC,o="number"==typeof t?st("".concat(t,"-01-01"),r):st(t,r,null==e?void 0:e.offset,!0),i="number"!=typeof t?o.year:t;if(null!=n&&"number"!=typeof t){var a=(n%=24)<0;n=n>=0?n:24+n;var u=o.year;a&&u--;var c=u+1,s=jt.findDate(u,n),l=jt.findDate(c,n),f=st("".concat(s[0],"-").concat(s[1],"-").concat(s[2]-1," 15:00:00"),!0),h=st("".concat(l[0],"-").concat(l[1],"-").concat(l[2]-1," 15:00:00"),!0);o.jdn<f.jdn?i--:t.valueOf()>=h.valueOf()&&i++}else if(null===n&&"number"!=typeof t){var g=_t.getLunarNewYearDay(i);o.jdn<g.jdn-1/24&&i--}return new Dt((i-4)%10,(i-4)%12,e)},t.computeSBMonth=function(t,e){var n,r=e&&void 0!==e.lang?e.lang:W.lang,o=e&&void 0!==e.changeAgeTerm?e.changeAgeTerm:W.changeAgeTerm;o=o||0;var i=null!==(n=null==e?void 0:e.isUTC)&&void 0!==n&&n,a={isUTC:i,offset:(null==e?void 0:e.offset)||0,lang:r,returnValue:!0,nodeFlag:(o+24)%2},u=jt.findNode(t,a),c=u[0],s=u[1],l=at(t,c,s,i);return new Dt(l,void 0,{lang:r})},t.computeSBDay=function(t,e){var n=(null==e?void 0:e.isUTC)||!1,r=(null==e?void 0:e.offset)||0,o=st(t,n,r,!0),i=st("".concat(R[0],"-").concat(R[1],"-").concat(R[2]-1," 15:00:00"),!0),a=Math.floor(o.jdn-r/1440-i.jdn)%60;return a<0&&(a+=60),new Dt(a,void 0,e)},t.computeSBHour=function(e,n,r){var o=(null==r?void 0:r.isUTC)||!1;n||(n=t.computeSBDay(e,r));var i,a,u=st(e,o,null==r?void 0:r.offset,!0).hour,c=n.stem,s=(u+1>>1)%12,l=(i=c.value,void 0===(a=s)&&(a=0),(i%5*2+a)%10);return new Dt(l,s,r)},t.prototype.toString=function(){return"".concat(this.year," ").concat(this.month," ").concat(this.day," ").concat(this.hour)},t.prototype.valueOf=function(){return this.value},t}(),Ct=function(t){function r(e,n){var r=t.call(this)||this;r._config=function(t){for(var e in t)Object.defineProperty(t,e,{writable:!1});return t}(Object.assign({extra:{}},W,n)),r.jd=st(e,r._config.isUTC,r._config.offset);var o=-1*r.jd.timezoneOffset;return r._config.extra.localTimezoneOffset=o,r._offset=r._config.offset,r}return e(r,t),Object.defineProperty(r.prototype,"lunisolar",{get:function(){return It},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"year",{get:function(){return this.jd.year},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"month",{get:function(){return this.jd.month},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"day",{get:function(){return this.jd.day},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dayOfWeek",{get:function(){return this.jd.dayOfWeek},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hour",{get:function(){return this.jd.hour},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"minute",{get:function(){return this.jd.minute},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"second",{get:function(){return this.jd.second},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"millisecond",{get:function(){return this.jd.millisecond},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lunar",{get:function(){return new _t(this.jd,{lang:this._config.lang,isUTC:this.isUTC()})},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"char8",{get:function(){var t={lang:this._config.lang,changeAgeTerm:this._config.changeAgeTerm,isUTC:this.isUTC(),offset:this._offset};return new Yt(this.jd,t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"solarTerm",{get:function(){var t=this.year;if(t<q||t>K)throw new Error("".concat(t,"  is not in the allowed time range."));var e=this.month,n=this.day,r=jt.getMonthTerms(t,e),o=r[0],i=r[1],a={lang:this._config.lang};return n===o?new jt(2*(e-1),a):n===i?new jt(2*(e-1)+1,a):null},enumerable:!1,configurable:!0}),r.prototype.recentSolarTerm=function(t){return jt.findNode(this.jd,{lang:this._config.lang,nodeFlag:t,returnValue:!1})},r.prototype.getMonthBuilder=function(t){void 0===t&&(t=0);var e={lang:this.getConfig("lang")},n=this.recentSolarTerm(t),r=n[0],o=n[1],i=at(this.toDate(),r.value,o);return[new Dt(i,void 0,e),r,o]},r.prototype.getSeasonIndex=function(){var t=this.recentSolarTerm(0)[0].value;return 2<=t&&t<8?0:8<=t&&t<14?1:14<=t&&t<20?2:3},r.prototype.getSeason=function(t){void 0===t&&(t=!1);var e=this.getSeasonIndex(),n=this.getLocale();return t&&n.seasonShortName?n.seasonShortName[e]:n.seasonName[e]},r.prototype.getLocale=function(t){return W.locales[null!=t?t:this._config.lang]},r.prototype.L=function(t){return function(t,e){for(var n=e.split("."),r=t,o=e,i=function(t){return("string"==typeof t||"number"==typeof t||"function"==typeof t)&&(o=t,!0)};n.length>=0&&!i(r)&&0!==n.length;){var a=n.shift();if(void 0===a)return"";if(Array.isArray(r)){var u=Number(a);if(isNaN(u)||u>=r.length)return"";r=r[u],o=r}else{if(!r.hasOwnProperty(a))return n[n.length-1]||a;r=r[a]}}return o}(this.getLocale(),t)},r.prototype.getConfig=function(t){return void 0===t?this._config:(this._config[t],this._config[t])},r.prototype.toDate=function(){return new Date(this.valueOf())},r.prototype.clone=function(){return new r(this.jd,this._config)},r.prototype.unix=function(){return Math.floor(this.valueOf()/1e3)},r.prototype.valueOf=function(){return this.jd.timestamp},r.prototype.local=function(){var t=Object.assign({},this._config,{isUTC:!1,offset:0});return new r({jdn:this.jd.jdn,jdms:this.jd.jdms},t)},r.prototype.utc=function(){return new r(this.jd,{isUTC:!0,offset:0})},r.prototype.isUTC=function(){return this._config.isUTC},r.prototype.utcOffset=function(t){if(void 0===t)return this.isUTC()?this._offset:(e=new Date,15*-Math.round(e.getTimezoneOffset()/15));var e,n=Object.assign({},this._config,{isUTC:!0,offset:Math.abs(t)<=16?60*t:t});return new r({jdn:this.jd.jdn,jdms:this.jd.jdms},n)},r.prototype.toISOString=function(){return this.jd.toISOString()},r.prototype.toUTCString=function(){return this.jd.toUTCString()},r.prototype.toString=function(){return this.jd.toUTCString()+" (".concat(this.lunar,")")+" utcOffset: ".concat(this.utcOffset())},r.prototype.format=function(t){return vt(t,this)},r.prototype.diff=function(t,e,n){return void 0===n&&(n=!1),e=e?ft(e):"millisecond",p.has(e)?function(t,e,n,r){var o=[t.lunar,e.lunar],i=o[1],a=[o[0].year,i.year],u=a[0],c=a[1],s=t.jd.jdn-e.jd.jdn;if((n=ft(n))===d){var l=u-c;return r?l-1+yt(e,!0)+yt(t,!1):l}return n===g?dt(t,e,r):(n===h&&(s*=12),r?s:Math.ceil(s))}(this,t instanceof r?t:new r(t,this._config),e,n):ht(this.jd,t,e,n)},r.prototype.add=function(t,e){return e||(e="ms"),new r(this.jd.add(t,e),this.getConfig())},n([N("lunisolar:lunar")],r.prototype,"lunar",null),n([N("lunisolar:char8")],r.prototype,"char8",null),n([N("lunisolar:solarTerm")],r.prototype,"solarTerm",null),n([N("lunisolar:recentSolarTerm",!0)],r.prototype,"recentSolarTerm",null),n([N("lunisolar:getMonthBuilder",!0)],r.prototype,"getMonthBuilder",null),r}(Ot),Pt=[5,7,11,13,-1,-2,17,19,23,1],Ut=[4,6,0,7],Nt=[1,1,8,8,8,3,3,3,4,4,4,9,9,9,2,2,2,7,7,7,6,6,6,1],Ht=new Map,Lt=function(t){void 0===t&&(t="zh");var e="direction24List:".concat(t);if(Ht.has(e))return Ht.get(e);var n={lang:t},r=[Tt.create(0,n),wt.create(9,n),Tt.create(1,n),Mt.create(4,n),Tt.create(2,n),wt.create(0,n),Tt.create(3,n),wt.create(1,n),Tt.create(4,n),Mt.create(6,n),Tt.create(5,n),wt.create(2,n),Tt.create(6,n),wt.create(3,n),Tt.create(7,n),Mt.create(0,n),Tt.create(8,n),wt.create(6,n),Tt.create(9,n),wt.create(7,n),Tt.create(10,n),Mt.create(7,n),Tt.create(11,n),wt.create(8,n)];return Ht.set(e,r),r};function At(t){if("number"==typeof t)return t;var e=t.constructor.name,n=t.value;if("Stem"===e)t=Pt[n];else if("Branch"===e)t=2*n;else{if("Trigram8"!==e)throw new Error("Invalid direction24 value");var r=Ut.indexOf(n);if(-1===r)throw new Error("Invalid direction24 value");t=3*(2*r+1)}return t}var xt=function(){function t(t,e){this._config={lang:W.lang};var n=At(t);this.value=n;var r=(null==e?void 0:e.lang)||W.lang,o=Lt(r);this._sign=-1===n?wt.create(4,e):-1===n?wt.create(5,e):o[n%24]}return t.create=function(e,n){var r=At(e),o=(null==n?void 0:n.lang)||"zh",i="".concat(r,":").concat(o);if(t.instances.has(i))return t.instances.get(i);var a=new t(r,n);return t.instances.set(i,a),a},t.createFromAngle=function(e,n){var r=Math.round(e%360/15);return t.create(r,n)},t.getNames=function(t){return t=t||W.lang,Lt(t).map((function(t){return t.name}))},Object.defineProperty(t.prototype,"sign",{get:function(){return this._sign},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._sign.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._sign.constructor.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this.value>0?15*this.value:NaN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return W.locales[this._config.lang].directions[this.directionIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"directionIndex",{get:function(){return this.value<0?5:Nt[this.value]},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._sign.toString()},t.prototype.valueOf=function(){return this.value},t.instances=new Map,t}(),Bt={parseJD:st,format:vt,dateDiff:ht};function It(t,e){return new Ct(t,e)}return It.utc=function(t,e){return new Ct(t,Object.assign({},e,{isUTC:!0}))},It.Lunar=_t,It.SolarTerm=jt,It.Char8=Yt,It.SB=Dt,It.Stem=wt,It.Branch=Tt,It.Element5=St,It.Lunisolar=Ct,It.Trigram8=Mt,It.Direction24=xt,It.JD=G,It.utils=Bt,It.fromLunar=function(t,e){var n=it(t,null==e?void 0:e.lang);return new Ct(n,e)},It.config=function(t){return t?(Object.assign(W,t),It):It},It.extend=function(t,e){return t.$once||(t(e,Ct,It),t.$once=!0),It},It.locale=function(t,e){if(void 0===e&&(e=!1),Array.isArray(t)){for(var n=0,r=t;n<r.length;n++){var o=r[n];It.locale(o,e)}return It}return t&&t.name?(W.locales[t.name]=Object.assign({},W.locales[t.name],V,t),e||(W.lang=t.name),e&&"zh"!==W.lang&&(W.locales[W.lang]=Object.assign({},W.locales.zh,W.locales[W.lang])),It):It},It.getLocale=function(t){return W.locales[t]},It.defineLocale=function(t){return t},It._globalConfig=W,Object.defineProperty(It,"_globalConfig",{writable:!1}),It}));
